run: DDPPO
name: res_force_exp01
local_dir: /checkpoint/jungdam/Research/ScaDive/data/learning/lafan1/imitation/
checkpoint_freq: 500
checkpoint_at_end: true
reuse_actors: true
stop: 
    time_total_s: 720000
config:
    env: HumanoidImitation
    log_level: WARN
    gamma: 0.95
    lambda: 0.95
    clip_param: 0.2
    kl_coeff: 0.0
    vf_clip_param: 1000
    num_sgd_iter: 20
    lr: 0.00002
    sgd_minibatch_size: 500
    horizon: 1200
    train_batch_size: 100000
    rollout_fragment_length: 100
    normalize_actions: false
    clip_actions: true
    num_envs_per_worker: 5
    num_cpus_per_worker: 5
    num_gpus_per_worker: 0
    remote_worker_envs: true
    framework: torch
    model:
        custom_model: task_agnostic_policy_type1
        custom_model_config:
            log_std_type: constant
            sample_std: 0.1
            task_encoder_type: "mlp"
            task_encoder_inputs:
                # - body
                - task
            task_encoder_output_dim: 64
            task_encoder_layers:
                - type: fc
                  hidden_size: 256
                  activation: "relu"
                  init_weight: 
                      name: normc
                      std: 1.0
                - type: fc
                  hidden_size: 128
                  activation: "relu"
                  init_weight: 
                      name: normc
                      std: 1.0
                - type: fc
                  hidden_size: output
                  activation: "linear"
                  init_weight: 
                      name: normc
                      std: 0.01
            
            body_encoder_enable: false

            motor_decoder_type: "mlp"
            motor_decoder_inputs:
                - body
                - task
            motor_decoder_layers:
                - type: fc
                  hidden_size: 256
                  activation: "relu"
                  init_weight: 
                      name: normc
                      std: 1.0
                - type: fc
                  hidden_size: 256
                  activation: "relu"
                  init_weight: 
                      name: normc
                      std: 1.0
                - type: fc
                  hidden_size: output
                  activation: "linear"
                  init_weight: 
                      name: normc
                      std: 0.01
    num_workers: 8
    num_gpus: 0
    batch_mode: truncate_episodes
    observation_filter: NoFilter
    env_config:
        lazy_creation: true
        project_dir: /private/home/jungdam/Research/ScaDive/
        fps_sim: 480
        fps_con: 30
        add_noise: false
        verbose: false
        ground:
            enable: true
            falldown_check:
                method: height
                height_min: 0.3
        state:
            choices: ['body', 'ref_motion_abs']
            body_type: facing_R6_h
        action:
            # Settings for base residual linear force
            use_base_residual_linear_force: true
            range_min_linear_force: -100.0
            range_max_linear_force: 100.0
            range_min_pol_linear_force: -3.0
            range_max_pol_linear_force: 3.0
            # Settings for base residual angular force
            use_base_residual_angular_force: true
            range_min_angular_force: -100.0
            range_max_angular_force: 100.0
            range_min_pol_angular_force: -3.0
            range_max_pol_angular_force: 3.0
            # Settings for PD-target pose
            type: "absolute"
            range_min: -3.0
            range_max: 3.0
            range_min_pol: -3.0
            range_max_pol: 3.0
        reward: 
            fn_def:
                default:
                    name: total
                    op: mul
                    child_nodes:
                      - name: pose_pos
                        op: leaf
                        weight: 1.0
                        kernel: 
                            type: gaussian
                            scale: 40.0
                      - name: pose_vel
                        op: leaf
                        weight: 1.0
                        kernel: 
                            type: gaussian
                            scale: 1.0
                      - name: ee
                        op: leaf
                        weight: 1.0
                        kernel: 
                            type: gaussian
                            scale: 5.0
                      - name: root
                        op: leaf
                        weight: 1.0
                        kernel: 
                            type: gaussian
                            scale: 2.5
                      - name: com
                        op: leaf
                        weight: 1.0
                        kernel: 
                            type: gaussian
                            scale: 2.5
            fn_map:
                - default
        early_term:
            # 'sim_div', 'sim_window', task_end', 'falldown', 'low_reward'
            choices:
                - ref_motion_end
                - low_reward
            low_reward_thres: 0.1
            eoe_margin: 0.2
        character:
            name:
                - agent1
            char_info_module:
                - lafan1_char_info.py
            sim_char_file:
                - data/character/lafan1.urdf
            ref_motion_scale:
                - 0.01
            base_motion_file:
                - data/motion/lafan1/lafan1_hierarchy.bvh
            ref_motion_db:
                -
                    data:
                        file:
                            # - ../ubisoft-laforge-animation-dataset/lafan1/lafan1/dance1_subject1.bvh
                            - data/motion/lafan1/lafan1_test.bvh
                            # - data/motion/lafan1/lafan1_hierarchy.bvh
            physics:
                -
                    actuation: spd
                    self_collision: true
            environment_file: []